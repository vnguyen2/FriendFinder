<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Survey</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
<body>
	<div class="container">
		<div class="jumbotron">
			<h1 class="text-center"><span class="glyphicon glyphicon-fire"></span>Friend Finder</h1>
			<hr>
			<h2 class="text-center">How relevant are the words listed below to you?</h2>
			<h3 class="text-center">(On a scale of 1 -- Not so much to 5)</h3>

			<form role="form">

                <div class="col-lg-8">
					<h3><strong>About You</strong></h3>
		    	</div>
		    	<div class="col-lg-8">
			        <div class="form-group">
			            <label for="name"><h4>Name</h4></label>
			            <input type="text" class="form-control" id="name" required>
			        </div>
			    </div>
		    	<div class="col-lg-8">
			        <div class="form-group">
			            <label for="photo"><h4>Link to Photo Image</h4></label>
			            <input type="text" class="form-control" id="image" required>
			        </div>
		        </div>

				<div class="form-group">
					<label for="">Grumpy</label>
                    <p>
                    <label class="radio-inline"><input id="option1" value="1"type="radio" name="q1"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q1"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q1"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q1"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q1"/>5</label>
                    </p>
                </div>
				<div class="form-group">
					<label for="">Happy</label>
                    <p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q2"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q2"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q2"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q2"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q2"/>5</label>
                    </p>
                </div>
				<div class="form-group">
					<label for="">Sleepy</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q3"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q3"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q3"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q3"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q3"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Bashful</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q4"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q4"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q4"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q4"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q4"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Smart</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q5"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q5"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q5"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q5"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q5"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Dopey</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q6"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q6"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q6"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q6"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q6"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Cynical</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q7"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q7"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q7"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q7"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q7"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Cute</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q8"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q8"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q8"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q8"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q8"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Smelly</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q9"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q9"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q9"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q9"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q9"/>5</label>
                    </p>
				</div>
				<div class="form-group">
					<label for="">Funny</label>
					<p>
					<label class="radio-inline"><input id="option1" value="1"type="radio" name="q10"/>1</label>
                    <label class="radio-inline"><input id="option2" value="2"type="radio" name="q10"/>2</label>
                    <label class="radio-inline"><input id="option3" value="3"type="radio" name="q10"/>3</label>
                    <label class="radio-inline"><input id="option4" value="4"type="radio" name="q10"/>4</label>
                    <label class="radio-inline"><input id="option5" value="5"type="radio" name="q10"/>5</label>
                    </p>
				</div>
				<button type="submit" class="btn btn-primary submit">Submit Answers</button>
			</form>

			<div class="text-center">
				<a href="/"><button type="button" class="btn btn-lg btn-default"><span class="glyphicon glyphicon-home"></span></button></a>		
			</div>
		</div>
	</div>

<div id="friendModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Your new friend is:</h4>
      </div>
      <div class="modal-body">
		<h3 id="userMatch"></h3>
		<div id="userPhoto"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

</body>
</html>

<script type="text/javascript">

var url = window.location.origin;

	$(".submit").on("click", function(){
		var answers = [];
		answers.push($('input[name=q1]').val());
		answers.push($('input[name=q2]').val());
		answers.push($('input[name=q3]').val());
		answers.push($('input[name=q4]').val());
		answers.push($('input[name=q5]').val());
		answers.push($('input[name=q6]').val());
		answers.push($('input[name=q7]').val());
		answers.push($('input[name=q8]').val());
		answers.push($('input[name=q9]').val());
		answers.push($('input[name=q10]').val());

        var userInfo = {
                    name: $('#name').val().trim(),
                    photo: $('#image').val().trim(),
                    score: answers
                };

        $.post(url + '/api/friends', userInfo, function(req, res) {
            //console.log(userInfo);           
            });
        
        $.get(url + '/api/friends', function(req, res){
			var match;
			var potentialMatch = 0;
			var index = 0;
			function compatibility(){
				var difference = [];
				for(var j=0; j<req.length - 1; j++){
					for(var i=0; i<userInfo.score.length; i++){
						potentialMatch += Math.abs(userInfo.score[i] - req[j].score[i]);
					}
					difference.push(potentialMatch);
					match = Math.min.apply(Math, difference);
					console.log("Lowest value: " + match);
					potentialMatch = 0;
				}
				var index = difference.indexOf(match);
				$('#userMatch').html(req[index].name);
				$('#userPhoto').html('<img style="width:400px; height; 400px;"src="'+ req[index].photo + '" >');
				$('#friendModal').modal('show'); 
			
			}
			compatibility();
		});
		return false;

    });

</script>